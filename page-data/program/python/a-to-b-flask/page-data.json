{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/program/python/a-to-b-flask/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Mushroom Records"}},"markdownRemark":{"id":"48612d8a-fad4-59da-b1ee-4a5bb3e4afc7","excerpt":"最初に Flask を理解するために奮闘した記事です。 ここ間違ってるよ、こう解釈すると良いよなどのアドバイスがあればコメントいただけると無茶苦茶嬉しいです。 出来上がったものがこちらになります。 https://neutrino-converter.herokuapp.com/ では、始めます。 概要 A to B…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d7c68955cb834dcb21752ad2d3ae2b3/21b4d/0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.32911392405063%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFUlEQVQoz32OW28SURCA+Xm898EHH2zsD/BJRU1Mq/FCpNgaigEVW0pBpEhrgbWhtEnTgsUCVUovy3V3ubjLLstlb2e356zZrYnWB7+cTCZn5psZC4RQlmUAgCzLoigCE9lEFCVJGCoirwhjjmZ4npdlSZEFIPYUaQQhtAAAWu12rVanKIplWbxSwStViqJIkqRpRhixPF3fX4t7nr/cDESYs7M+1+I75zzbUVXVkMvlcqFQyOVy4XC4WDwqlY4/b2zEE4nNVOowm4ktBhbn3PhexmGbSYSDOuTGg59cjzZkVVUpqs32B45Z543JyUQyKcnAOev0v/emUtjyW198Kfgju938drDw2P7a/oTr4hzdZJieKQNwXiVrLe7Bw5k7d227u3v1Futwzsc++k6+ZyKroej6B5/90dytm2s+99T1a7mvW+MBPeC6F5p5NkkQ3U5nZ3tnYmICw7B+n1sJBmuVMl7OR7zz755NR5/aPt2eWnXeX5i+l/S+kkfUqNfUFMGiaRrP8xzXVxTF5XJZrVYMw3AcPzk9VUZ9Mr9/GPUfbIWKX5aOYu5c1J8NrEjDjjDsaZpqyJKJogBd19PptMfjeeFwBAPLxy2hRA0Zlm4QZKVWJwiCaDSqjbqqqUjXEUIWeBXdBCEjvsmjUMnIIDJaDcGsQXT5iSz6XyCELkwghOhygDEH/eZPopvvqvwP5sL/1PVfjj01qSpHiH8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"0\"\n        title=\"0\"\n        src=\"/static/3d7c68955cb834dcb21752ad2d3ae2b3/f058b/0.png\"\n        srcset=\"/static/3d7c68955cb834dcb21752ad2d3ae2b3/c26ae/0.png 158w,\n/static/3d7c68955cb834dcb21752ad2d3ae2b3/6bdcf/0.png 315w,\n/static/3d7c68955cb834dcb21752ad2d3ae2b3/f058b/0.png 630w,\n/static/3d7c68955cb834dcb21752ad2d3ae2b3/40601/0.png 945w,\n/static/3d7c68955cb834dcb21752ad2d3ae2b3/78612/0.png 1260w,\n/static/3d7c68955cb834dcb21752ad2d3ae2b3/21b4d/0.png 1280w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1>最初に</h1>\n<p>Flask を理解するために奮闘した記事です。<br>\nここ間違ってるよ、こう解釈すると良いよなどのアドバイスがあればコメントいただけると無茶苦茶嬉しいです。<br>\n出来上がったものがこちらになります。<br>\n<a href=\"https://neutrino-converter.herokuapp.com/\">https://neutrino-converter.herokuapp.com/</a><br>\nでは、始めます。</p>\n<h1>概要</h1>\n<ul>\n<li>A to B の形で<strong>文字列を変換する</strong>系の Web アプリを制作する</li>\n<li>NEUTRINO で作業するときに文字にスペースを入れる作業がめんどくさいので、これを利用してめんどくさくなくす</li>\n</ul>\n<p><img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/5209e84d-6169-00a7-efd4-a67896131747.png\" alt=\"127.0.0.1_5000_.png\"></p>\n<h1>第一部　「Flask を準備する」</h1>\n<p>使用する言語は僕がそれしか使えないので Python です。<br>\nFlask というモジュールを使用しますが、実はこれが初体験です。<br>\n1 から手順を追って説明していきましょう。</p>\n<h2>pip で Flask をインストール</h2>\n<p>今回の開発には<code class=\"language-text\">pipenv</code>を使用ましたが、本記事は<code class=\"language-text\">pip</code>で説明します。<br>\n以下コマンドを実行して Flask を導入します。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pip install Flask</code></pre></div>\n<h2>ディレクトリを準備する</h2>\n<ul>\n<li><code class=\"language-text\">project</code>のディレクトリに<code class=\"language-text\">app</code>,<code class=\"language-text\">models</code>フォルダを作成します。</li>\n<li><code class=\"language-text\">models</code>フォルダ内に<code class=\"language-text\">__init__.py</code></li>\n<li><code class=\"language-text\">app</code>フォルダ内に<code class=\"language-text\">templates</code>,<code class=\"language-text\">static</code>フォルダを作成します。</li>\n<li><code class=\"language-text\">app</code>フォルダ内に<code class=\"language-text\">app.py</code>を作成します。</li>\n<li><code class=\"language-text\">project</code>ディレクトリに<code class=\"language-text\">run.py</code>を作成します。</li>\n</ul>\n<p>気がつくとこうなってると思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">project\n ├app/\n │ ├templates/\n │ ├static/\n │ └app.py\n ├models/\n │ └__init__.py\n └run.py</code></pre></div>\n<h2>html を用意する</h2>\n<p><code class=\"language-text\">app/templates</code>フォルダに<code class=\"language-text\">index.html</code>を用意します。<br>\nだいたい中身はこんな感じとなっています。<br>\nこれが<strong>出力されるページのモトとなります。</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"html:tltle=index.html\"><pre class=\"language-html:tltle=index.html\"><code class=\"language-html:tltle=index.html\">&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Musescore流し込み用文字変換&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;h1&gt;ここはindex.htmlだよ！&lt;/h1&gt;\n    &lt;/body&gt;\n&lt;/html&gt;</code></pre></div>\n<h2>Python ファイルを用意する</h2>\n<p>先程作った<code class=\"language-text\">〜.py</code>の中身を組み立てていきます。</p>\n<h3>run.py</h3>\n<p>サーバーを立ち上げる際に実行します。<br>\n単純に app を呼び出して run する、という書き方で。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>run.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> app<span class=\"token punctuation\">.</span>app <span class=\"token keyword\">import</span> app\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>app.py</h3>\n<p>Web アプリの根幹となる部分です。<br>\nとりあえず<code class=\"language-text\">Hello World.</code>を表示させときましょう。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>app.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span> render_template<span class=\"token punctuation\">,</span> request\n\n<span class=\"token comment\"># Flaskオブジェクトの生成</span>\napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 単純に文字列を表示するだけ</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'hello world.'</span>\n\n\n<span class=\"token comment\"># 〜/index にアクセスがあった場合、index.htmlを描写する</span>\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/index'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>中身の解説については後ほど行います。<br>\nとりあえずこれで準備が整いました。</p>\n<h1>第二部　「とりあえず実行してみよう」</h1>\n<p>最小構成が出来上がりました。<br>\nではこの構成で一度サーバーを立ち上げてみましょう。<br>\n立ち上げ方は、<strong>flask が実行できる環境で</strong><code class=\"language-text\">run.py</code>を実行する、です。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python run.py</code></pre></div>\n<p>実行するとターミナルにいろいろ文字が出てきますが、注視する点はこれです。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)</code></pre></div>\n<p>表示されている URL を開くと、このような画面が出てくるはずです。</p>\n<p><img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/ccfe9ef6-c457-c5d9-95eb-3e2b72e7020b.png\" alt=\"スクリーンショット 2020-11-03 2.04.56.png\"></p>\n<p>この画面と Python コードを見比べてみましょう。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>app.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Hello World'</span></code></pre></div>\n<p>このコードの意味は以下の通りとなります。</p>\n<ul>\n<li><code class=\"language-text\">/</code>、つまり<code class=\"language-text\">http://127.0.0.1:5000/</code>にアクセスすると関数を呼び出す。</li>\n<li>関数では単純に、文字列<code class=\"language-text\">Hello World</code>が返されているだけ。</li>\n<li>この関数の返り値である<code class=\"language-text\">Hello World</code>がページに反映される。</li>\n</ul>\n<p>といった感じです、なんとなく理解はできましたでしょうか？</p>\n<p>確か、こういったコードも入力しましたよね。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>app.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 〜/index にアクセスがあった場合、index.htmlを描写する</span>\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/index'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>このコードの意味は以下の通りとなります。</p>\n<ul>\n<li><code class=\"language-text\">/index</code>、つまり<code class=\"language-text\">http://127.0.0.1:5000/index</code>にアクセスすると関数を呼び出す。</li>\n<li>関数では、render_template(‘index.html’)が返されている。</li>\n<li><code class=\"language-text\">render</code>…描写する</li>\n<li><code class=\"language-text\">template</code>…テンプレート</li>\n<li>つまり、<code class=\"language-text\">render_template('index.html')</code>は、<strong>テンプレートとして<code class=\"language-text\">index.html</code>を描写する</strong>といった意味です。</li>\n<li>即ち、<code class=\"language-text\">http://127.0.0.1:5000/index</code>にアクセスすると、<code class=\"language-text\">index.html</code>が表示されます。</li>\n</ul>\n<p>といった感じです。<br>\nなんとな〜く、仕組みが理解できてきたと思います。<br>\nなんとなくで良いのです、僕も詳しい意味はわからないので…</p>\n<h1>第三部　「ページを作っていこう」</h1>\n<h2>おさらい</h2>\n<p>今回作りたいのはこんなページです。</p>\n<p><img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/5209e84d-6169-00a7-efd4-a67896131747.png\" alt=\"127.0.0.1_5000_.png\"></p>\n<p>このページに必要な要素を組んでいきましょう。</p>\n<h2>index.html を組む</h2>\n<p>さっきまで触っていた html は普通の html でしたが、ここから少し違った html の書き方をします。</p>\n<div class=\"gatsby-highlight\" data-language=\"html:index.html\"><pre class=\"language-html:index.html\"><code class=\"language-html:index.html\">&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Musescore流し込み用文字変換&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;!-- form --&gt;\n    &lt;form action=&quot;/&quot; method=&quot;POST&quot;&gt;\n        &lt;textarea name=&quot;before&quot; rows=&quot;4&quot; cols=&quot;40&quot;&gt;ここにテキストを入れてね&lt;/textarea&gt;\n        &lt;input type=&quot;submit&quot; value=&quot;変換&quot;&gt;\n        {% if body %}\n        &lt;textarea name=&quot;after&quot; rows=&quot;4&quot;&gt;{{body}}&lt;/textarea&gt;\n        {% else %}\n        &lt;textarea name=&quot;after&quot; rows=&quot;4&quot;&gt;ボタンを押すとこっちに出力されるよ&lt;/textarea&gt;\n        {% endif %}\n    &lt;/form&gt;\n    &lt;!-- form --&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre></div>\n<p>見慣れない文字が出てきましたね、順を追って説明しましょう。</p>\n<ul>\n<li><code class=\"language-text\">{% if A %}</code>,<code class=\"language-text\">{% endif %}</code>に挟まれた html は、条件 A を満たさないと表示されない。\n<blockquote>\n<p>これの書き方がちょっとよくわからないんですけども、Web アプリ詳しい方いたら解説いただきたいです…</p>\n</blockquote>\n</li>\n<li>Flask 側から<code class=\"language-text\">body</code>という要素を受け取ると、<code class=\"language-text\">{{body}}</code>にそれが挿入される。</li>\n</ul>\n<p>といった感じです、プログラミングかじったことあるならば見慣れたような気がしますね。\nでは、以下の点に注目しましょう。</p>\n<blockquote>\n<p>Flask 側から<code class=\"language-text\">body</code>という要素を受け取ると、<code class=\"language-text\">{{body}}</code>にそれが挿入される。</p>\n</blockquote>\n<p>これはどういった感じなのでしょうか？<br>\n実際に Flask 側、から<code class=\"language-text\">body</code>という要素を渡す<code class=\"language-text\">app.py</code>がこちらになります。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>app.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    body <span class=\"token operator\">=</span> <span class=\"token string\">'hoge'</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">,</span> body<span class=\"token operator\">=</span>body<span class=\"token punctuation\">)</span></code></pre></div>\n<p>簡単な話ですね、返り値の引数に<code class=\"language-text\">body</code>を用意してあげればいいのです。<br>\n逆に、<code class=\"language-text\">html側</code>から<code class=\"language-text\">Flask側</code>に要素を渡す際はこうなります。</p>\n<div class=\"gatsby-highlight\" data-language=\"html:index.html\"><pre class=\"language-html:index.html\"><code class=\"language-html:index.html\">&lt;form action=&quot;/&quot; method=&quot;POST&quot;&gt;\n    &lt;textarea name=&quot;before&quot; rows=&quot;4&quot; cols=&quot;40&quot;&gt;ここにテキストを入れてね&lt;/textarea&gt;\n    &lt;input type=&quot;submit&quot; value=&quot;変換&quot;&gt;\n&lt;/form&gt;</code></pre></div>\n\n        <div class=\"gatsby-code-title\">\n          <span>app.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">body <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'before'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">POSTするform</code>を組み、このフォームを実行するとアクションが起こるページを<code class=\"language-text\">action</code>で指定します。</li>\n<li><code class=\"language-text\">textarea</code>に<code class=\"language-text\">name=\"before\"</code>を設定します。</li>\n<li><code class=\"language-text\">input</code>に<code class=\"language-text\">type=\"submit\"</code>を設定します。</li>\n<li>この状態でボタンを押すと、<strong>Flask 側で指定した要素を html から取得した</strong>、という形でページが表示されます。</li>\n</ul>\n<p>つまり、</p>\n<p>これが\n<img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/7a1a22bf-6ebd-7f0e-62a6-e4d66f939f9e.png\" alt=\"スクリーンショット 2020-11-03 2.35.53.png\"></p>\n<p>こうなります\n<img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/e3760fe6-8c2a-4f01-ccb2-d5ce5f9f77f5.png\" alt=\"スクリーンショット 2020-11-03 2.36.48.png\"></p>\n<p>…おや、なんか手順がすっ飛んでますね。<br>\nすっとんだ手順について追っていきましょう。</p>\n<h1>第四部　「文字列を変換する機構を作る」</h1>\n<p>そうです、文字列をどのように変換したかがすっ飛んでいます。</p>\n<h2>自作モジュールは models フォルダへ入れる</h2>\n<p>自作のモジュールを Flask で使用する場合、<code class=\"language-text\">models</code>フォルダにまとめておきましょう。<br>\nフォルダの中身はこんな感じにしておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">models/\n ├__init__.py\n └convert.py</code></pre></div>\n<p><code class=\"language-text\">__init__.py</code>を置くことで、models から import できるようにします。</p>\n<blockquote>\n<p>参考: <a href=\"https://qiita.com/karadaharu/items/37403e6e82ae4417d1b3\">Python 3 でのファイルの import のしかたまとめ - Qiita</a></p>\n</blockquote>\n<p>それでは、<code class=\"language-text\">convert.py</code>をいじっていきましょう。</p>\n<h2>正規表現で文字列を変換する</h2>\n<p>今回は正規表現で攻めていきます。<br>\n各々関数にまとめたかったのですが、正直行数節約にもならなそうだったので一つにまとめちゃいました。</p>\n<p>手順を説明するとこういった感じです。</p>\n<ul>\n<li><code class=\"language-text\">(.)</code>で文字列を検索し、<code class=\"language-text\">\\1 </code>で文字列に変更を加えないまま、スペースを後方に配置する。</li>\n<li><code class=\"language-text\">\\s(ゃ|ゅ|ょ|〜)</code>で<code class=\"language-text\"> 拗音</code>となっている文字列を検索し、余分なスペースを削除する。\n<blockquote>\n<p>これについてもっとスマートな方法がある気がするのですが、知ってたら教えてください。</p>\n</blockquote>\n</li>\n<li><code class=\"language-text\">\\s{2,}</code>で 2 つ以上連続しているスペースを検索し、余分なスペースを削除する。</li>\n</ul>\n\n        <div class=\"gatsby-code-title\">\n          <span>convert.py</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> re\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    pattern_before <span class=\"token operator\">=</span> <span class=\"token string\">r'(.)'</span>\n    pattern_after <span class=\"token operator\">=</span> <span class=\"token string\">r'\\1 '</span>\n    s <span class=\"token operator\">=</span> arg\n    s <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span>pattern_before<span class=\"token punctuation\">,</span> pattern_after<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span>\n\n    pattern_before <span class=\"token operator\">=</span> <span class=\"token string\">r'\\s(ゃ|ゅ|ょ|ぁ|ぃ|ぅ|ぇ|ぉ|ャ|ュ|ョ|ァ|ィ|ゥ|ェ|ォ)'</span>\n    pattern_after <span class=\"token operator\">=</span> <span class=\"token string\">r'\\1'</span>\n    s <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span>pattern_before<span class=\"token punctuation\">,</span> pattern_after<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span>\n\n    pattern_before <span class=\"token operator\">=</span> <span class=\"token string\">r'\\s{2,}'</span>\n    pattern_after <span class=\"token operator\">=</span> <span class=\"token string\">r' '</span>\n    s <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>sub<span class=\"token punctuation\">(</span>pattern_before<span class=\"token punctuation\">,</span> pattern_after<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> s</code></pre></div>\n<h2>convert.py を app.py で呼び出す</h2>\n<p>それでは、<code class=\"language-text\">app.py</code>から<code class=\"language-text\">convert.py</code>を呼び出して使用します。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span></span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"pythonapp.py\"><pre class=\"language-pythonapp.py\"><code class=\"language-pythonapp.py\">from models import convert\n\n@app.route(&#39;/&#39;, methods=[&#39;post&#39;])\ndef post():\n    body = request.form[&#39;before&#39;]\n    body = convert.convert(body)\n    return render_template(&#39;index.html&#39;, body=body)</code></pre></div>\n<ul>\n<li><code class=\"language-text\">from models import convert</code>で convert を import する。</li>\n<li>フォームのボタンを押すと<code class=\"language-text\">before</code>要素を取得する</li>\n<li><code class=\"language-text\">before</code>に対して<code class=\"language-text\">convert</code>関数を実行する。</li>\n<li>変換した文字列<code class=\"language-text\">body</code>を描写する</li>\n</ul>\n<p>といった感じです。</p>\n<p>つまり、これでようやく</p>\n<p>これが\n<img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/7a1a22bf-6ebd-7f0e-62a6-e4d66f939f9e.png\" alt=\"スクリーンショット 2020-11-03 2.35.53.png\"></p>\n<p>こうなる\n<img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/e3760fe6-8c2a-4f01-ccb2-d5ce5f9f77f5.png\" alt=\"スクリーンショット 2020-11-03 2.36.48.png\"></p>\n<p>とちゃんと説明できたわけです。</p>\n<h1>第五部　「機能ができたら次は外見」</h1>\n<p>このままだと見た目がちょっとダサいので、bootstrap を使って見た目を整えます。</p>\n<p><code class=\"language-text\">app</code>フォルダ内に<code class=\"language-text\">static</code>というフォルダがあります。<br>\nここに、CSS や JS などを入れていくわけです。<br>\n今回、CSS のみを使用するので JS フォルダは用意しません。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">app/\n └static/\n   └css\n     └bootstrap.min.css</code></pre></div>\n<p>といった構成でいきましょう。<br>\nbootstrap をいじるわけですから…<code class=\"language-text\">index.html</code>ですよね。</p>\n<div class=\"gatsby-highlight\" data-language=\"html:index.html\"><pre class=\"language-html:index.html\"><code class=\"language-html:index.html\">&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n    &lt;title&gt;Musescore流し込み用文字変換&lt;/title&gt;\n    &lt;link href=&quot;../static/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;\n\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;div class=&quot;jumbotron text-center&quot;&gt;\n        &lt;h1 class=&quot;display-4&quot;&gt;Lyrics -&gt; Musescore&lt;/h1&gt;\n        &lt;p class=&quot;lead&quot;&gt;for NEUTRINO&lt;/p&gt;\n        &lt;hr class=&quot;my-4&quot;&gt;\n        &lt;p&gt;NEUTRINO用にMusescoreを用意する際に流し込む歌詞にスペースを自動で追加するやつです。&lt;/p&gt;\n        &lt;p&gt;あいうえおきゃきゅきょ→あ い う え お きゃ きゅ きょ &lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;!-- form --&gt;\n    &lt;form action=&quot;/&quot; method=&quot;POST&quot;&gt;\n        &lt;div class=&quot;container-fluid&quot;&gt;\n            &lt;div class=&quot;row justify-content-around form-group&quot;&gt;\n                &lt;textarea class=&quot;col-11 col-md-4 form-control&quot; name=&quot;before&quot; rows=&quot;4&quot; cols=&quot;40&quot;&gt;ここにテキストを入れてね&lt;/textarea&gt;\n                &lt;div class=&quot;col-md-1 my-md-auto&quot;&gt;\n                    &lt;input type=&quot;submit&quot; class=&quot;btn btn-primary btn-lg&quot; value=&quot;変換&quot;&gt;\n                &lt;/div&gt;\n                {% if body %}\n                &lt;textarea class=&quot;col-11 col-md-4 form-control&quot; name=&quot;after&quot; rows=&quot;4&quot;&gt;{{body}}&lt;/textarea&gt;\n                {% else %}\n                &lt;textarea class=&quot;col-11 col-md-4 form-control&quot; name=&quot;after&quot; rows=&quot;4&quot;&gt;ボタンを押すとこっちに出力されるよ&lt;/textarea&gt;\n                {% endif %}\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/form&gt;o\n\n    &lt;!-- form --&gt;\n    &lt;footer class=&quot;text-muted &quot;&gt;\n        &lt;div class=&quot;container&quot;&gt;\n            &lt;p class=&quot;text-center&quot;&gt;\n                連絡はこちらへ:&lt;a href=&quot;https://twitter.com/_Sotono&quot;&gt;@_Sotono&lt;/a&gt;\n            &lt;/p&gt;\n        &lt;/div&gt;\n    &lt;/footer&gt;\n\n\n&lt;/body&gt;\n\n&lt;/html&gt;</code></pre></div>\n<p>これでようやく見た目がこうなりました。</p>\n<p><img src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/207577/5209e84d-6169-00a7-efd4-a67896131747.png\" alt=\"127.0.0.1_5000_.png\"></p>\n<p>長い旅路だった…<br>\nあとはこれを公開するなり煮るなり焼くなりして自由に取り扱うことができます。</p>\n<h1>番外編　「詰まったところと解決策」</h1>\n<ul>\n<li>\n<p>Q.テストで<code class=\"language-text\">app.py</code>を実行してるのに、<code class=\"language-text\">No module named app</code>とか表示されて動かない…</p>\n</li>\n<li>\n<p>A.<code class=\"language-text\">run.py</code>を実行しましょう、全部解決します。</p>\n</li>\n<li>\n<p>Q.なんかよくわからない長文エラーを吐き出しています…<code class=\"language-text\">jinja2.exceptions.TemplateNotFound</code>とか末端に書いてある…</p>\n</li>\n<li>\n<p>A.<code class=\"language-text\">index.html</code>と<code class=\"language-text\">app.py</code>がうまく噛み合ってないかもしれないです、コードをちゃんと確認しましょう。存在しない要素呼び出してませんか？</p>\n</li>\n</ul>\n<h1>おわりに</h1>\n<p>長い文章になりました。<br>\n今回これを作ったのは、趣味で作曲をしているときに「あーめんどくせ！！！」って思ったからです。<br>\nNEUTRINO はすごい技術だと思うので今後の発展に期待しています。<br>\nおわり。</p>","frontmatter":{"title":"A to Bな変換系WebアプリをFlaskで作ろう！ゼロから…","date":"2020/11","description":"Python,Flask"}}},"pageContext":{"id":"48612d8a-fad4-59da-b1ee-4a5bb3e4afc7","previousPostId":"b97c9dc6-3d9e-5618-9062-c1b721a61705","nextPostId":"68b92f72-c9e3-56f4-aa23-df34d73997a0"}},
    "staticQueryHashes": ["3713412316"]}